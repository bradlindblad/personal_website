<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Brad Lindblad">
<meta name="dcterms.date" content="2019-10-20">
<meta name="description" content="Save future-you time">
<title>Technistema - Building a Corporate R Package for Pleasure and Profit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../inst/brad_headshot_faded.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Technistema</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts">
 <span class="menu-text"><i class="fa-solid fa-list" aria-label="list"></i> Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks">
 <span class="menu-text"><i class="fa-solid fa-bullhorn" aria-label="bullhorn"></i> Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html">
 <span class="menu-text"><i class="fa-solid fa-chalkboard-user" aria-label="chalkboard-user"></i> Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../writing.html">
 <span class="menu-text"><i class="fa-solid fa-book" aria-label="book"></i> Writing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html">
 <span class="menu-text"><i class="fa-solid fa-paper-plane" aria-label="paper-plane"></i> Contact</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bradlindblad"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bradlindblad"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
    /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://technistema.us4.list-manage.com/subscribe/post?u=f26fc35d39dcb0e92c5821415&amp;id=63967509e3" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Get blog posts sent to your inbox</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required=""><!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--><div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f26fc35d39dcb0e92c5821415_63967509e3" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#tools" id="toc-tools" class="nav-link active" data-scroll-target="#tools">Tools</a></li>
  <li><a href="#create-an-empty-package-project" id="toc-create-an-empty-package-project" class="nav-link" data-scroll-target="#create-an-empty-package-project">Create an empty package project</a></li>
  <li><a href="#custom-functions" id="toc-custom-functions" class="nav-link" data-scroll-target="#custom-functions">Custom functions</a></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets">Datasets</a></li>
  <li><a href="#now-we-build" id="toc-now-we-build" class="nav-link" data-scroll-target="#now-we-build">Now, we build</a></li>
  <li><a href="#database-connections" id="toc-database-connections" class="nav-link" data-scroll-target="#database-connections">Database connections</a></li>
  <li>
<a href="#branded-ggplot-visualizations" id="toc-branded-ggplot-visualizations" class="nav-link" data-scroll-target="#branded-ggplot-visualizations">Branded ggplot visualizations</a>
  <ul class="collapse">
<li><a href="#get-the-colors" id="toc-get-the-colors" class="nav-link" data-scroll-target="#get-the-colors">Get the colors</a></li>
  <li><a href="#create-the-functions" id="toc-create-the-functions" class="nav-link" data-scroll-target="#create-the-functions">Create the functions</a></li>
  </ul>
</li>
  <li>
<a href="#markdown-templates" id="toc-markdown-templates" class="nav-link" data-scroll-target="#markdown-templates">Markdown templates</a>
  <ul class="collapse">
<li><a href="#create-skeleton-directory" id="toc-create-skeleton-directory" class="nav-link" data-scroll-target="#create-skeleton-directory">1. Create skeleton directory</a></li>
  <li><a href="#create-skeleton.rmd" id="toc-create-skeleton.rmd" class="nav-link" data-scroll-target="#create-skeleton.rmd">2. Create skeleton.Rmd</a></li>
  <li><a href="#create-the-yaml-file" id="toc-create-the-yaml-file" class="nav-link" data-scroll-target="#create-the-yaml-file">3. Create the yaml file</a></li>
  </ul>
</li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What’s next?</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Building a Corporate R Package for Pleasure and Profit</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">R package</div>
  </div>
  </div>

<div>
  <div class="description">
    Save future-you time
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brad Lindblad </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 20, 2019</p>
    </div>
  </div>
  
    
  </div>
  

</header><p><a href="https://www.linkedin.com/in/bradlindblad/">LinkedIn</a> | <a href="https://github.com/bradlindblad/">Github</a> | <a href="https://technistema.com/">Blog</a> | <a href="https://technistema.com/contact/">Subscribe</a></p>
<p><img src="hero.png" class="img-fluid"></p>
<p>The “Great Restructuring” of our economy is underway. That’s the official name for what we know is happening: the best are rising to the top, and the mediocre are sinking to the bottom. It’s the Matthew Principle in-motion.</p>
<p>In Brynjolfsson and McAfee’s 2011 book Race Against the Machine, they detail how this New Economy will favor those that have the skill set or the capital to interface and invest in new technologies such as deep learning and robotics, which are becoming more ubiquitous every day.</p>
<p>Cal Newport’s Deep Work outlines two core abilities for thriving in this new economy:</p>
<blockquote class="blockquote">
<ol type="1">
<li>Be able to quickly master hard things</li>
</ol>
</blockquote>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Be able to produce at an elite level, in terms of both quality and speed. This need for speed (sorry) will be our focus.</li>
</ol>
</blockquote>
<p><strong>Don’t repeat yourself (DRY)</strong> is a well-known maxim in software development, and most R programmers follow this rule and build functions to avoid duplicating code. But how often do you:</p>
<ul>
<li>Reference the same dataset in different analyses</li>
<li>Create the same ODBC connection to a database</li>
<li>Tinker with the same colors and themes in ggplot</li>
<li>Produce markdown docs from the same template</li>
</ul>
<p>and so on? Notice a pattern? The word “same” is sprinkled in each bullet point. I smell an opportunity to apply DRY!</p>
<p>If you work in a corporate or academic setting like me, you probably do these things pretty often. I’m going to show you how to wrap all of these tasks into a minimalist R package to save you time, which, as we’ve learned, is one of the keys to your success in the New Economy.</p>
<section id="tools" class="level2"><h2 class="anchored" data-anchor-id="tools">Tools</h2>
<p>First some groundwork. I’ll assume if you work in R that you are using RStudio, which will be necessary to follow along. I’m using R version 3.5.1 on a Windows 10 machine (ahh, corporate America…). Note that the package we are about to develop is minimalist, which is a way of saying that we’re gonna cut corners to make a minimum viable product. We won’t get deep into documentation and dependencies much, as the packages we’ll require in our new package are more than likely already on your local machine.</p>
</section><section id="create-an-empty-package-project" class="level2"><h2 class="anchored" data-anchor-id="create-an-empty-package-project">Create an empty package project</h2>
<p>We’ll be creating a package for the consulting firm <a href="https://www.ketchbrookanalytics.com/">Ketchbrook Analytics</a>, a boutique shop from Connecticut who know their way around a %&gt;% better than anyone.</p>
<p>Open RStudio and create a project in a new directory:</p>
<p><img src="1.png" class="img-fluid"><br>
Select <strong>R Package</strong> and give it a name. I’ll call mine ketchR.</p>
<p><img src="2.png" class="img-fluid"></p>
<p>RStudio will now start a new session with an example “hello” function. Looks like we’re ready to get down to business.</p>
</section><section id="custom-functions" class="level2"><h2 class="anchored" data-anchor-id="custom-functions">Custom functions</h2>
<p>Let’s start by adding a function to our package. A common task at Ketchbrook is mapping customer data with an outline for market area or footprint. We can easily wrap that into a simple function.</p>
<p>Create a new R file and name it ketchR.R. We’ll put all of our functions in here.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># To generate the footprint_polys data</span>
<span class="va">footprint_poly</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>

  <span class="co">#' Returns object of class SpatialPolygons of the AgC footprint.</span>
  <span class="co">#' Utilizes the Tigris:: package.</span>


  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris">tigris</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
  <span class="co"># Get County Polygons</span>
  <span class="va">states.raw</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/states.html">states</a></span><span class="op">(</span><span class="op">)</span>

  <span class="va">states</span> <span class="op">&lt;-</span> <span class="va">states.raw</span><span class="op">[</span><span class="va">states.raw</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">STUSPS</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CA"</span>, <span class="st">"OR"</span>, <span class="st">"WA"</span><span class="op">)</span>,<span class="op">]</span>

  <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html">st_as_sfc</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span>
  <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span>
  <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/coerce-methods.html">as</a></span><span class="op">(</span><span class="va">states</span>, <span class="st">'Spatial'</span><span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span>


<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So what we’ve done is create a function that utilizes the tigris package to grab shapefiles for states in our footprint. The function then unions those states into one contiguous polygon so we can easily overlay this using leaflet, ggmap, etc.</p>
<p>Try your new function out:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addPolygons</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">footprint_poly</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="3.png" class="img-fluid"></p>
<p>There is no limit to what kinds of custom functions you can add in your package. Machine learning algs, customer segmentation, whatever you want you can throw in a function with easy access in your package.</p>
</section><section id="datasets" class="level2"><h2 class="anchored" data-anchor-id="datasets">Datasets</h2>
<p>Let’s stay on our geospatial bent. Branch or store-level analysis is common in companies spread out over a large geographical region. In our example, Ketchbrook’s client has eight branches from Tijuana to Seattle. Instead of manually storing and importing a CSV or R data file each time we need to reference these locations, we can simply save the data set to our package.</p>
<p>In order to add a dataset to our package, we first need to pull it into our local environment either by reading a csv or grabbing it from somewhere else. I simply read in a csv from my local PC:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">branches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"O:\\exchange\\branches.csv"</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is what the data set looks like:</p>
<p><img src="4.png" class="img-fluid"></p>
<p>Now, we have to put this data in a very specific place, or our package won’t be able to find it. Like when my wife hides the dishwasher so I’m reluctantly forced to place dirty dishes on the counter.</p>
<p>First, create a folder in your current directory called “data.” Your directory should look like this now, btw:</p>
<p><img src="5.png" class="img-fluid"></p>
<p>Bonus points: use the terminal feature in RStudio to create the directory easily:</p>
<p><img src="6.png" class="img-fluid"></p>
<p>Now we need to save this branches data set into our new folder as an .RData file:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">branches</span>, file <span class="op">=</span> <span class="st">"data/branches.RData"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="now-we-build" class="level2"><h2 class="anchored" data-anchor-id="now-we-build">Now, we build</h2>
<p>Let’s test this package out while there’s still a good chance we didn’t mess anything up. When we build the package, we are compiling it into the actual package as we know it. In RStudio, this is super simple. Navigate to the “Build” tab, and click “Install and Restart.” If you’ve followed along, you shouldn’t see any errors, but if you do see errors, try updating your local packages.</p>
<p>Now, we should be able to call our package directly and use our branches dataset:</p>
<p><img src="7.png" class="img-fluid"></p>
<p>Cool, that works. Now let’s plot our branches with Leaflet quick to make sure footprint_poly() worked:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addPolygons</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">ketchR</span><span class="fu">::</span><span class="fu">footprint_poly</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/leaflet/man/leaflet-imports.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addCircles</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">branches</span>,
             lat <span class="op">=</span> <span class="va">branches</span><span class="op">$</span><span class="va">lat</span>,
             lng <span class="op">=</span> <span class="va">branches</span><span class="op">$</span><span class="va">lon</span>,
             radius <span class="op">=</span> <span class="fl">40000</span>,
             stroke <span class="op">=</span> <span class="cn">F</span>,
             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="8.png" class="img-fluid"></p>
<p>Niiiice.</p>
</section><section id="database-connections" class="level2"><h2 class="anchored" data-anchor-id="database-connections">Database connections</h2>
<p>One of the most common tasks in data science is pulling data from databases. Let’s say that Ketchbrook stores data in a SQL Server. Instead of manually copy and pasting a connection script or relying on the RStudio session to cache the connection string, let’s just make a damn function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">get_db</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">query</span> <span class="op">=</span> <span class="st">"SELECT TOP 10 * FROM datas.dbo.Customers"</span><span class="op">)</span> <span class="op">{</span>

  <span class="co">#' Pull data from database</span>
  <span class="co">#' @param query: enter a SQL query; Microsoft SQL syntax please</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://odbc.r-dbi.org">odbc</a></span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">odbc</span><span class="op">(</span><span class="op">)</span>,
                   Driver <span class="op">=</span> <span class="st">"SQL Server"</span>,
                   Server <span class="op">=</span> <span class="st">"datas"</span>,
                   Database <span class="op">=</span> <span class="st">"dataserver"</span>,
                   UID <span class="op">=</span> <span class="st">"user"</span>,
                   PWD <span class="op">=</span> <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/askForSecret.html">askForSecret</a></span><span class="op">(</span><span class="st">"password"</span><span class="op">)</span>,
                   Port <span class="op">=</span> <span class="fl">6969</span><span class="op">)</span>



  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">odbc</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>, <span class="va">query</span><span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>

  <span class="fu">odbc</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con</span><span class="op">)</span>

<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, we’re building a function that lets us enter any query we want to bang against this SQL Server. The function creates the connection, prompts us to enter the password each time (we don’t store passwords in code…) and closes the connection when it’s through.</p>
<p>Let’s take it a step further. Many times you may pull a generic SELECT * query in order to leverage dplyr to do your real data munging. In this case, it’s easier to just make a function that does just that.</p>
<p>Let’s make another function that pulls a SELECT * FROM Customers.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">get_customers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>

  <span class="co">#' Pull most recent customer data from db - datascience.agc_Customers</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://odbc.r-dbi.org">odbc</a></span><span class="op">)</span>
  <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">odbc</span><span class="op">(</span><span class="op">)</span>,
                   Driver <span class="op">=</span> <span class="st">"SQL Server"</span>,
                   Server <span class="op">=</span> <span class="st">"datas"</span>,
                   Database <span class="op">=</span> <span class="st">"dataserver"</span>,
                   UID <span class="op">=</span> <span class="st">"user"</span>,
                   PWD <span class="op">=</span> <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/askForSecret.html">askForSecret</a></span><span class="op">(</span><span class="st">"password"</span><span class="op">)</span>,
                   Port <span class="op">=</span> <span class="fl">6969</span><span class="op">)</span>


  <span class="va">query1</span> <span class="op">&lt;-</span> <span class="st">"SELECT * FROM datas.dbo.Customers"</span>
  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">odbc</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>, <span class="va">query1</span><span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>

  <span class="fu">odbc</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con</span><span class="op">)</span>


<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ahh, this alone saved me quarters-of-hours each week once I started using it in my own practice. Think hard about any piece of code that you may copy and paste on a regular basis — that’s a candidate for your packages stable of functions.</p>
</section><section id="branded-ggplot-visualizations" class="level2"><h2 class="anchored" data-anchor-id="branded-ggplot-visualizations">Branded ggplot visualizations</h2>
<p>Ok now we’re getting to the <em>primo</em> honey, the real time-savers, the analyst-impresser parts of our package. We’re going to make it easy to produce consistent data visualizations which reflect a company’s image with custom colors and themes.</p>
<p>Although I personally believe the viridis palette is the best color scheme of all time, it doesn’t necessarily line up with Ketchbrook’s corporate color palette. So let’s make our own set of functions to use Ketchbrook’s palette is a ‘lazy’ way. (Big thanks to this <a href="https://www.r-bloggers.com/creating-corporate-colour-palettes-for-ggplot2/">Simon Jackson’s great article</a>).</p>
<section id="get-the-colors" class="level3"><h3 class="anchored" data-anchor-id="get-the-colors">Get the colors</h3>
<p>Let’s pull the colors directly from <a href="https://www.ketchbrookanalytics.com/">their website</a>. We can use the Chrome plugin <a href="https://chrome.google.com/webstore/detail/colorzilla/bhlhnicpbhignbdhedgjhgdocnmhomnp">Colorzilla</a> to pull the colors we need.</p>
<p><img src="9.png" class="img-fluid"></p>
<p>Take those hex color codes and paste them into this chunk like so:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Palette main colors</span>
<span class="va">ketch.styles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  `salmon` <span class="op">=</span> <span class="st">"#F16876"</span>,
  `light_blue`<span class="op">=</span> <span class="st">"#00A7E6"</span>,
  `light_grey` <span class="op">=</span> <span class="st">"#E8ECF8"</span>,
  `brown`  <span class="op">=</span> <span class="st">"#796C68"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will give us a nice palette that has colors different enough for categorical data, and similar enough for continuous data. We can even split this up into two separate sub-palettes for this very purpose:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Create separate palettes</span>
<span class="va">agc.palettes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  `main`  <span class="op">=</span> <span class="fu">styles</span><span class="op">(</span><span class="st">'salmon'</span>,<span class="st">'light_blue'</span>, <span class="st">'brown'</span>, <span class="st">'light_grey'</span><span class="op">)</span>,

  `cool`  <span class="op">=</span> <span class="fu">styles</span><span class="op">(</span><span class="st">'light_blue'</span>, <span class="st">'light_grey'</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="create-the-functions" class="level3"><h3 class="anchored" data-anchor-id="create-the-functions">Create the functions</h3>
<p>I’m not going to go through these functions line by line; if you have questions reach out to me at bradley.lindblad[at]gmail[dot]com, create an issue on the Github repo. Here is the full code snippet:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">
<span class="co"># Palette main colors</span>
<span class="va">ketch.styles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  `salmon` <span class="op">=</span> <span class="st">"#F16876"</span>,
  `light_blue`<span class="op">=</span> <span class="st">"#00A7E6"</span>,
  `light_grey` <span class="op">=</span> <span class="st">"#E8ECF8"</span>,
  `brown`  <span class="op">=</span> <span class="st">"#796C68"</span><span class="op">)</span>

<span class="co"># Fn to extract them by hex codes</span>
<span class="va">styles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>

  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="va">ketch.styles</span><span class="op">)</span>

  <span class="va">ketch.styles</span><span class="op">[</span><span class="va">cols</span><span class="op">]</span>
<span class="op">}</span>

<span class="co"># Create separate palettes</span>
<span class="va">ketch.palettes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  `main`  <span class="op">=</span> <span class="fu">styles</span><span class="op">(</span><span class="st">'salmon'</span>,<span class="st">'light_blue'</span>, <span class="st">'brown'</span>, <span class="st">'light_grey'</span><span class="op">)</span>,

  `cool`  <span class="op">=</span> <span class="fu">styles</span><span class="op">(</span><span class="st">'light_blue'</span>, <span class="st">'light_grey'</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Fn to access them</span>
<span class="va">ketch_pal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">palette</span> <span class="op">=</span> <span class="st">"main"</span>, <span class="va">reverse</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">pal</span> <span class="op">&lt;-</span> <span class="va">ketch.palettes</span><span class="op">[[</span><span class="va">palette</span><span class="op">]</span><span class="op">]</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">reverse</span><span class="op">)</span> <span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">pal</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="va">pal</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Fn for customer scale</span>
<span class="va">scale_color_ketch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">palette</span> <span class="op">=</span> <span class="st">"main"</span>, <span class="va">discrete</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">reverse</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">ketch_pal</span><span class="op">(</span>palette <span class="op">=</span> <span class="va">palette</span>, reverse <span class="op">=</span> <span class="va">reverse</span><span class="op">)</span>

  <span class="co">#' Scale color using AgC color palette.</span>
  <span class="co">#' @param palette: main, greens or greys</span>
  <span class="co">#' @param discrete: T or F</span>
  <span class="co">#' @param reverse: reverse the direction of the color scheme</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">discrete</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/discrete_scale.html">discrete_scale</a></span><span class="op">(</span><span class="st">"colour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ketch_"</span>, <span class="va">palette</span><span class="op">)</span>, palette <span class="op">=</span> <span class="va">pal</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">pal</span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>


<span class="va">scale_fill_ketch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">palette</span> <span class="op">=</span> <span class="st">"main"</span>, <span class="va">discrete</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">reverse</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>

  <span class="co">#' Scale fill using AgC color palette.</span>
  <span class="co">#' @param palette: main, greens or greys</span>
  <span class="co">#' @param discrete: T or F</span>
  <span class="co">#' @param reverse: reverse the direction of the color scheme</span>

  <span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">ketch_pal</span><span class="op">(</span>palette <span class="op">=</span> <span class="va">palette</span>, reverse <span class="op">=</span> <span class="va">reverse</span><span class="op">)</span>

  <span class="kw">if</span> <span class="op">(</span><span class="va">discrete</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/discrete_scale.html">discrete_scale</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ketch_"</span>, <span class="va">palette</span><span class="op">)</span>, palette <span class="op">=</span> <span class="va">pal</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">pal</span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s test it out:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span>, color <span class="op">=</span> <span class="va">qsec</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ketchR</span><span class="fu">::</span><span class="fu">scale_color_ketch</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"main"</span>, discrete <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces:</p>
<p><img src="10.png" class="img-fluid"></p>
</section></section><section id="markdown-templates" class="level2"><h2 class="anchored" data-anchor-id="markdown-templates">Markdown templates</h2>
<p>Now that we’ve fetched the data and plotted the data much more quickly, the final step is to communicate the results of our analysis. Again, we want to be able to do this quickly and consistently. A custom markdown template is in order.</p>
<p>I found this part to be the hardest to get right, as everything needs to be in the right place within the file structure, so follow closely. (Most of the credit here goes to <a href="https://ismayc.github.io/ecots2k16/template_pkg/">this article by Chester Ismay</a>.)</p>
<section id="create-skeleton-directory" class="level3"><h3 class="anchored" data-anchor-id="create-skeleton-directory">1. Create skeleton directory</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="st">"ketchbrookTemplate/inst/rmarkdown/templates/report/skeleton"</span>,
    recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This creates a nested directory that will hold our template .Rmd and .yaml files. You should have a new folder in your directory called “ketchbrookTemplate”:</p>
<p><img src="11.png" class="img-fluid"></p>
</section><section id="create-skeleton.rmd" class="level3"><h3 class="anchored" data-anchor-id="create-skeleton.rmd">2. Create skeleton.Rmd</h3>
<p>Next we create a new RMarkdown file:</p>
<p><img src="12.png" class="img-fluid"></p>
<p>This will give us a basic RMarkdown file like this:</p>
<p><img src="13.png" class="img-fluid"></p>
<p>At this point let’s modify the template to fit our needs. First I’ll replace the top matter with a theme that I’ve found to work well for me, feel free to rip it off:</p>
<pre><code>---
title: "ketchbrookTemplate"
author: Brad Lindblad
output: 
  prettydoc::html_pretty:
    theme: cayman
    number_sections: yes
    toc: yes
  pdf_document: 
    number_sections: yes
    toc: yes
  rmarkdown::html_document:
    theme: cayman
  html_notebook: 
    number_sections: yes
    theme: journal
    toc: yes
header-includes:
  - \setlength{\parindent}{2em}
  - \setlength{\parskip}{0em}
date: February 05, 2018
always_allow_html: yes
#bibliography: bibliography.bib
abstract: "Your text block here"
---</code></pre>
<p>I like to follow an analysis template, so this is the top matter combined with my basic EDA template:</p>
<pre><code>--
title: "Customer Service Survey EDA"
author: Brad Lindblad, MBA
output: 
  pdf_document: 
    number_sections: yes
    toc: yes
  html_notebook: 
    number_sections: yes
    theme: journal
    toc: yes
  rmarkdown::html_document:
    theme: cayman
  prettydoc::html_pretty:
    theme: cayman
    number_sections: yes
    toc: yes
header-includes:
  - \setlength{\parindent}{2em}
  - \setlength{\parskip}{0em}
date: September 20, 2018
always_allow_html: yes
bibliography: bibliography.bib
abstract: "Your text block here"

---

Writing Your Report
Now that you've done the necessary preparation, you can begin writing your report. To start, keep in mind there is a simple structure you should follow. Below you'll see the sections in order along with descriptions of each part.

Introduction

Summarize the purpose of the report and summarize the data / subject.
Include important contextual information about the reason for the report.
Summarize your analysis questions, your conclusions, and briefly outline the report.
Body - Four Sections

Data Section - Include written descriptions of data and follow with relevant spreadsheets.
Methods Section - Explain how you gathered and analyzed data.
Analysis Section - Explain what you analyzed. Include any charts here.
Results - Describe the results of your analysis.
Conclusions

Restate the questions from your introduction.
Restate important results.
Include any recommendations for additional data as needed.
Appendix

Include the details of your data and process here. 
Include any secondary data, including references.

::: {.cell}

:::

# Introduction

# Data

# Methods

# Analysis

# Results

# Conclusions

# Appendix

# References</code></pre>
<p>Save this file in the skeleton folder and we’re done here.</p>
</section><section id="create-the-yaml-file" class="level3"><h3 class="anchored" data-anchor-id="create-the-yaml-file">3. Create the yaml file</h3>
<p>Next we need to create a yaml file. Simply create a new text document called “template.yaml” in RStudio and save it like you see in this picture:</p>
<p><img src="14.png" class="img-fluid"></p>
<p>Rebuild the package and open a new RMarkdown document, select “From Template” and you should see your new template available:</p>
<p><img src="15.png" class="img-fluid"></p>
<p>Sweet. You can now knit to html pretty and have sweet output like this:</p>
<p><img src="16.png" class="img-fluid"></p>
<p>If you run into problems, make sure your file structure matches this:</p>
<pre><code>├───inst
│   └───rmarkdown
│       └───templates
│           └───ketchbrookTemplate
│               │   template.yaml
│               │
│               └───skeleton
│                       skeleton.nb.html
│                       skeleton.Rmd</code></pre>
</section></section><section id="whats-next" class="level2"><h2 class="anchored" data-anchor-id="whats-next">What’s next?</h2>
<p>So we’ve essentially made a bomb package that will let you do everything just a little more quickly and a little better: pull data, reference common data, create data viz and communicate results.</p>
<p>From here, you can use the package locally, or push it to a remote Github repository to spread the code among your team.</p>
<p>The full code for this package is available at the Github repo set up for it. Feel free to fork it and make it your own. I’m not good at goodbye’s so I’m just gonna go.</p>
<hr>
<p><strong><em>Want more content like this?</em></strong> <a href="https://technistema.com/contact/">Subscribe here</a></p>


</section><script data-goatcounter="https://datalogos.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>